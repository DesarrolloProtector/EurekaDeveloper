DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'IdentityDEMO.Models.ApplicationDbContext'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202202071641346_InitialCreate'
BEGIN
    CREATE TABLE [dbo].[AspNetRoles] (
        [Id] [nvarchar](128) NOT NULL,
        [Name] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetRoles] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [RoleNameIndex] ON [dbo].[AspNetRoles]([Name])
    CREATE TABLE [dbo].[AspNetUserRoles] (
        [UserId] [nvarchar](128) NOT NULL,
        [RoleId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserRoles]([UserId])
    CREATE INDEX [IX_RoleId] ON [dbo].[AspNetUserRoles]([RoleId])
    CREATE TABLE [dbo].[AspNetUsers] (
        [Id] [nvarchar](128) NOT NULL,
        [Email] [nvarchar](256),
        [EmailConfirmed] [bit] NOT NULL,
        [PasswordHash] [nvarchar](max),
        [SecurityStamp] [nvarchar](max),
        [PhoneNumber] [nvarchar](max),
        [PhoneNumberConfirmed] [bit] NOT NULL,
        [TwoFactorEnabled] [bit] NOT NULL,
        [LockoutEndDateUtc] [datetime],
        [LockoutEnabled] [bit] NOT NULL,
        [AccessFailedCount] [int] NOT NULL,
        [UserName] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUsers] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [UserNameIndex] ON [dbo].[AspNetUsers]([UserName])
    CREATE TABLE [dbo].[AspNetUserClaims] (
        [Id] [int] NOT NULL IDENTITY,
        [UserId] [nvarchar](128) NOT NULL,
        [ClaimType] [nvarchar](max),
        [ClaimValue] [nvarchar](max),
        CONSTRAINT [PK_dbo.AspNetUserClaims] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserClaims]([UserId])
    CREATE TABLE [dbo].[AspNetUserLogins] (
        [LoginProvider] [nvarchar](128) NOT NULL,
        [ProviderKey] [nvarchar](128) NOT NULL,
        [UserId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey], [UserId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserLogins]([UserId])
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[AspNetRoles] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserClaims] ADD CONSTRAINT [FK_dbo.AspNetUserClaims_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserLogins] ADD CONSTRAINT [FK_dbo.AspNetUserLogins_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202202071641346_InitialCreate', N'IdentityDEMO.Models.ApplicationDbContext',  0x1F8B0800000000000400DD5CDB6EE436127D5F60FF41D05376E1B47CC90C668D7602A76DEF1A195F30ED09F236604BECB63012A548946363912FDB877C527E618B1275E14D976EB9BB1D0408DC62F154B15864158BC5F9F37F7F4C7F780E03EB0927A91F9133FB6872685B98B891E793D5999DD1E5B71FEC1FBEFFFBDFA6975EF86CFD5CD29D303AE849D233FB91D2F8D47152F71187289D84BE9B4469B4A413370A1DE445CEF1E1E1BF9CA3230703840D589635FD9411EA8738FF013F671171714C3314DC441E0E52FE1D5AE639AA758B429CC6C8C567F6B587A12F7DB9B8BCB99B14E4B6751EF8084499E360695B889088220A829E7E4EF19C261159CD63F8808287971803DD120529E60338ADC9FB8EE5F0988DC5A93B96506E96D2281C087874C295E3C8DDD752B15D290FD47799AB8A8D3A5761ADBD4F51000A90199ECE8284119FD937158BF334BEC57452769C14905709C0FD16255F274DC403AB77BF83CA988E2787ECBF036B9605344BF019C1194D507060DD678BC0777FC22F0FD1574CCE4E8E16CB930FEFDE23EFE4FD77F8E45D73A43056A0133EC0A7FB248A7102B2E165357EDB72C47E8EDCB1EAD6E85368056C09D6856DDDA0E78F98ACE823AC98E30FB675E53F63AFFCC28DEB33F1611941279A64F0F3360B02B40870D5EEB4F264FF6FE17AFCEEFD285C6FD193BFCAA75EE20F0B278175F50907796BFAE8C7C5F212E6FB0B27BB4AA290FD16EDAB68FD328FB2C46583898C240F2859612A4A37756AE3ED65D20C6A7CB32E51F7DFB499A4AA796B49D980D65909258B6DAF8652DED7E5DBDBE2CEE318262F372DA6913683D378AB89D4FDC06A12D5C673D4D778080CEAAFBC175E86C80F46D80C7B70814064E92721AE46F96304A687C86099EF519AC25EE0FD07A58F2DA2C39F23883EC76E9680FDCC290AE357E776FF18117C9B850B66F9DBE335DAD43CFC165D219746C92561BD36C6FB18B95FA38C5E12EF0251FC99BA2520FBF9E087FD014611E7DC75719A5E8131636F16419C5D025E137A723C188EED50BB0E466601F2437D3422EDA55F4AD23A22D153285189814C1799B489FA315AF9A49FA825A959D482A253544E36545406D64F524E69163427E894B3A01A2DD6CB6768FC602F87DDFF686F33E76DDA0B1A6A9CC30E89FF8D094E601BF3EE11A53821F50CF4D93776112CE4D3C798BEBA6FCA39FD8C826C6C566BAD867C13187F35E4B0FBBF1A7231E1F393EFB1A8A4C711A82406F85EF4FAD355F79A9324DBF6721086B96DE6DBD9034CCBE53C4D23D7CF578126F9C55317A2FC10C359DD798C6234722E04060686EE3397075F606CB66C5477E402079862EBDC2D92833394BAC853D50803F20608567A548D60754E4414EE9F0A4FB0749CB04E881D825258A93EA1EAB2F089EBC728E8D492D4B3A70B6363AF78C82D1738C68431ECD4441FE6FA140813A0E2234D4A9786A64EC3E2DA0DD110B59AE6BC2B84ADE75DC94C6CC5263B6267835DF2F8ED550CB35D635B30CE7695F411C098CEDB8581F2B34A5F03900F2EFB66A0D289C960A03CA4DA8A818A1ADB81818A2A7973065A1C51FBCEBF745EDD37F3140FCADB77EBADEADA816D0AFAD833D32C624FE843A1074E54F3BC58B046FC4C35873390939FCF521EEACA26C2C0E7988A299B3ADED5C6A14E3B886C446D80B5A17580F28B400548595003842B7379ADD2F12862006C99776B85E57BBF04DBB00115BB7921DA20345F9BCAC6D9EBF4518DACB206C5C87B1D161A381A8390372F71E03D9462CACBAA8AE9130B0F89861B03E393D1A2A08EC8D5A0A47230A36BA934CD6E2DE902B22121D9465A92C2278396CAC18CAE256EA3DD4AD2040503C2828D5424BAF091165B99E9A8BC4DD536758A4229FE61EA182AAAA637288E7DB26A5458F12FD6BC28AF9A7D3B1F5E761416188E9B6AAA8F2A692B4E344AD00A4BADC01A24BDF293945E208A1688E579665EA890697DAB61FB2F5936DDA73A89A51F28A9D9DFE2DEDEBCBE179CAD1A8D70902B1862C8429A3C8FAE31007D778B95BCA100259AD4FD2C0AB29098232C73EFE202AFD9BFF8A2224C1D497E258252D4A5C4B9A2EE7BCD8CBA2AC69AA52A82597FA6CC10267D97F16753E3A698D48C52A6A89A28A6B4D5CE66CE14CA0C9B2D394C1C3E599D08AFB3B2786D4A13807F1A88D1286F50C01A6DFD51C50A9426A6D8D21F512A3369424A4D03A46C16930842361BD6C23368544FD19F835A3ED244575BFB236B0A499AD09AE635B03532CB6DFD5135B5264D604D737FECBAF044DE45F7D877190F2FEB3BAFE280BB99F73260BCCE96388EF36BDCE337811A9F0762F19B7A058C7FDF4B73329EF2D637A722B1B199391930CC7B8F70052E6E3DADF7F6664CE15E5BD8DEDBEEF5CD78C38CF6554D4339E5C92415F7EAB4279DEAA6FC84D5FD984639721524B655AA115CFB4B4A7138610493F9AFC12CF031DBC84B821B44FC254E6951CB611F1F1E1D4BCF71F6E7698C93A65EA039A19ADEC78873B685B22CF28412F711256A91C406CF476A5025FF7C4D3CFC7C66FF37EF759AA732D85FF9E703EB3AFD4CFC5F33687848326CFDAE167D8E534EDFE3014725E8EF6FE265447F955FFFF2A5E87A60DD25B09C4EAD4349D1EB4CBFF85E62903445D70DA459FB15C5DB5D6DC203052DAAB45AD67F8FB0F0E9286F114A29BF09D1F33F868AA67D6FB011A2E64DC15878A3A8D0F466601D2CE37B010F7ED2FCBDC0B0C1EADF0FAC239AF1ED804F8683C92F07FA6F4365CF1DFA21CD89691B5B52AEE7CECAEB8DCA3077ED9B9402ED8D16BA5A843D006ED442EBCD42943756C03C9AEBD4D4278F86BD4BBB7FF5A2E47DA943AE83F6DD961F6FB3E2B8E54EE92F5568BC07A5719A529FDD97136FDBD64C29E03DAFC91C5634BC67C6C6DDFCEE4B83B76D6CA604F19E1BDBA002E03DB3B55DF9CF1D5B5A6F17BAF3725EB532C97095A3CB227795EB16297738FE2F22308222A22C5E59EAEBC34CCC6A633132AC49CC4CCD8569326365E1287C158A76B6C3C6CA1D7EEB60394D3B5B4339671B6FBEFFB7F2E634EDBC0D4592BB2834D69629EA8ABF3BF6B1B60AAAB754582C8CA4A38EBD2B666DBD977F4B75C4A32845583D86DBE5B753363C8A4AC65C3A03CA84D58B62F09D8D7F9B11FC77EAAF6A08F62F3512EC0A5EB3A2B926CBA874DE9244258994A1B9C11479E052CF13EA2F914BA19925A0F367E279528F5D832CB0774DEE321A6714868CC3452024BC5810D0C63FAF8516659EDEC5EC573AC610404C9F25EEEFC88F991F7895DC579A9C90018245173CDDCBE692B2B4EFEAA542BA8D484F20AEBE2A287AC0611C00587A47E6E809AF231B98DF47BC42EE4B9D013481744F84A8F6E9858F56090A538E51F7879F60C35EF8FCFDFF017EE628BDA2540000 , N'6.2.0-61023')
END

